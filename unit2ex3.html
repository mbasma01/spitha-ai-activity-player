<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Prep: Student Attendance Analysis</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Highlight.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f0f4f8; }
        .fade-in { animation: fadeIn 0.5s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Custom Scrollbar for code blocks */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }

        .step-indicator { transition: all 0.3s ease; }
        .step-active { background-color: #3b82f6; color: white; border-color: #3b82f6; }
        .step-done { background-color: #10b981; color: white; border-color: #10b981; }
        .step-pending { background-color: white; color: #94a3b8; border-color: #cbd5e1; }

        /* Blur effect for hidden code */
        .code-blur {
            filter: blur(8px);
            user-select: none;
            pointer-events: none;
        }
        .reveal-overlay {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-5xl mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="bg-blue-600 text-white p-2 rounded-lg">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                    </svg>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-gray-800">Exercise 3</h1>
                    <p class="text-xs text-gray-500">Module: Attendance Prediction Dataset</p>
                </div>
            </div>
            <button onclick="downloadCSV()" class="flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition-colors shadow-sm">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                </svg>
                Download CSV (Optional)
            </button>
        </div>
    </header>

    <!-- Progress Bar -->
    <div class="bg-white border-b">
        <div class="max-w-3xl mx-auto px-4 py-4">
            <div class="flex justify-between items-center relative">
                <!-- Line background -->
                <div class="absolute top-1/2 left-0 w-full h-1 bg-gray-200 -z-10 rounded"></div>
                <!-- Steps generated by JS -->
                <div id="stepContainer" class="w-full flex justify-between"></div>
            </div>
        </div>
    </div>

    <!-- Main Content Area -->
    <main class="flex-grow flex items-center justify-center p-4">
        <div id="contentArea" class="max-w-3xl w-full">
            <!-- Content injected here via JS -->
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-400 py-6 text-center text-sm mt-auto">
        <p>Unit 2 Exercise</p>
    </footer>

    <script>
        // --- 1. DATA PREPARATION ---
        const csvContent = `student_id,age,gender,course,year,parent_education,internet_access,hostel_resident,class_type,weather,study_hours,sleep_hours,travel_time_minutes,attendance,absence_reason
200.99,17,male,pharmacy,1st year,high school,no,yes,offline,sunny,3.63,7.24,31,1,none
200.99,23,other,diploma,2nd year,high school,yes,yes,offline,cloudy,4.39,7.98,50,0,no reason
200.99,22,male,b.sc,3rd year,no formal,yes,yes,online,rainy,5.43,6.53,62,1,none
200.99,20,other,pharmacy,2nd year,no formal,yes,yes,offline,cloudy,0.21,7.11,63,0,personal work
200.99,20,female,pharmacy,1st year,no formal,yes,yes,online,sunny,1.77,9.35,81,0,project work
200.99,23,male,b.tech,4th year,no formal,yes,yes,offline,hot,4.8,9.36,38,1,none
200.99,17,female,b.tech,1st year,phd,yes,no,offline,cloudy,4.8,4.96,7,0,personal work
19800.01,19,male,pharmacy,2nd year,high school,yes,yes,offline,hot,3.2,8.6,53,1,none
19800.01,22,other,bba,1st year,graduate,no,no,offline,sunny,3.07,9.94,18,1,none
19800.01,19,other,bba,2nd year,post graduate,yes,yes,offline,sunny,0.38,6.8,5,0,none
19800.01,20,male,diploma,4th year,no formal,no,yes,online,hot,1.81,5.88,78,0,personal work
19800.01,18,male,ba,4th year,graduate,yes,no,offline,hot,3.6,4.79,85,1,none
19800.01,20,female,bba,1st year,graduate,no,no,offline,cold,0.05,7.03,63,0,personal work
19800.01,19,other,pharmacy,1st year,high school,yes,no,offline,sunny,4.69,4.8,22,0,project work
19800.01,24,female,b.tech,2nd year,graduate,yes,no,offline,rainy,3.5,6.5,45,1,none`;

        function downloadCSV() {
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement("a");
            const url = URL.createObjectURL(blob);
            link.setAttribute("href", url);
            link.setAttribute("download", "attendance_prediction.csv");
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // --- 2. WORKSHOP DATA ---
        const steps = [
            {
                title: "Setup",
                type: "task",
                instruction: "Let's start by importing pandas and loading our dataset. You can load it directly from GitHub (Recommended) or upload the file to Colab.",
                task: "Choose one of the two options below to load your data.",
                code: `import pandas as pd

# Option 1: Load directly from GitHub (Recommended)
url = 'https://raw.githubusercontent.com/mbasma01/spitha-ai-notebooks/main/Attendance_Prediction.csv'
df = pd.read_csv(url)

# Option 2: Use if you uploaded the file manually
# df = pd.read_csv('attendance_prediction.csv')

# View the dataframe
df.head()`,
                hint: "If using Option 2, make sure you clicked the 'Upload' button in the files tab of Google Colab first."
            },
            {
                title: "The 'Data Frame' Concept",
                type: "concept",
                heading: "Why did we do that?",
                text: "In AI, we rarely work with raw Excel files or text directly. We convert them into <strong>DataFrames</strong>.<br><br>Think of a DataFrame as a programmable spreadsheet. It allows the computer to process millions of rows of data in milliseconds, which is essential for training Machine Learning models.",
                icon: "üìä"
            },
            {
                title: "Inspection",
                type: "task",
                instruction: "Before we can predict attendance, we need to know what our data looks like.",
                task: "Check the data types and missing values using .info()",
                code: `# Check data types and missing values
df.info()`,
                hint: "Look closely at the output. Do you see 'Object' (text) vs 'Float' (numbers)? Are there any Null values?"
            },
            {
                title: "The 'Sanity Check' Concept",
                type: "concept",
                heading: "Why inspect data?",
                text: "An AI model is only as good as the data you feed it (Garbage In, Garbage Out).<br><br>Using <code>head()</code> lets you visually verify the data structure.<br>Using <code>info()</code> is critical for finding <strong>Null</strong> values. Most AI algorithms crash if you feed them empty (Null) data, so finding them early is a key skill.",
                icon: "üßê"
            },
            {
                title: "Target Analysis",
                type: "task",
                instruction: "We want to build an AI that predicts if a student attends class. Let's look at the students who are absent.",
                task: "Filter the data to show only rows where 'attendance' is 0 (Absent).",
                code: `# Filter for absent students
absent_students = df[df['attendance'] == 0]

# Colab will display this as a nice table
absent_students.head()`,
                hint: "Remember syntax: df[ df['column'] == value ]"
            },
            {
                title: "The 'Labeling' Concept",
                type: "concept",
                heading: "Understanding Labels",
                text: "In Machine Learning, 'attendance' is our <strong>Target Variable</strong> (or Label).<br><br>By filtering for specific classes (0 vs 1), we can start to see patterns manually. For example, do absent students tend to have lower sleep hours? This manual intuition helps you choose better features for your model later.",
                icon: "üéØ"
            },
            {
                title: "Correlation",
                type: "task",
                instruction: "Let's test a hypothesis: Do students who study less tend to be absent more?",
                task: "Calculate the average study hours for students who attend (1) vs those who are absent (0).",
                code: `# Group by attendance and calculate mean study hours
study_stats = df.groupby('attendance')['study_hours'].mean()

study_stats`,
                hint: "The groupby() function splits the data, and .mean() aggregates it."
            },
            {
                title: "The 'Feature' Concept",
                type: "concept",
                heading: "Feature Importance",
                text: "You just performed a basic <strong>Feature Correlation</strong> check.<br><br>If the average study hours are significantly different between group 0 and group 1, then 'study_hours' will be a <strong>Strong Feature</strong> for your AI model. If they are the same, the model might ignore this column.",
                icon: "üìà"
            },
            {
                title: "Deep Dive: Reasons",
                type: "task",
                instruction: "We know WHICH students are absent, but we don't know WHY. Let's look at the 'absence_reason' column.",
                task: "Use value_counts() on the 'absence_reason' column to see the most common excuses.",
                code: `# Count the frequency of each reason
reason_counts = df['absence_reason'].value_counts()

reason_counts`,
                hint: "value_counts() is the best way to summarize categorical (text) data."
            },
            {
                title: "The 'Categorical Data' Concept",
                type: "concept",
                heading: "Handling Text Data",
                text: "The 'absence_reason' column contains text (Categories).<br><br>AI models prefer numbers. Before training, we often have to convert these categories into numbers using techniques like <strong>One-Hot Encoding</strong>. Seeing the unique values first helps us decide how to encode them.",
                icon: "üî†"
            },
            {
                title: "Cross Analysis",
                type: "task",
                instruction: "Does having internet access affect attendance? Let's check the relationship between these two variables.",
                task: "Use pd.crosstab() to compare 'internet_access' and 'attendance'.",
                code: `# Create a cross-tabulation table
internet_impact = pd.crosstab(df['internet_access'], df['attendance'])

internet_impact`,
                hint: "Crosstab takes two arguments: the row Series and the column Series."
            },
            {
                title: "Travel Time Check",
                type: "task",
                instruction: "Do students living far away (high travel time) tend to miss class more often?",
                task: "Group by 'attendance' and find the mean 'travel_time_minutes'.",
                code: `# Average travel time for attendees vs absentees
travel_stats = df.groupby('attendance')['travel_time_minutes'].mean()

travel_stats`,
                hint: "This is similar to the study_hours check we did earlier, just a different column!"
            },
            {
                title: "Complex Filter",
                type: "task",
                instruction: "Final Challenge: Let's find 'At Risk' students: Those who study less than 2 hours AND are absent.",
                task: "Create a complex filter using the & (AND) operator.",
                code: `# Filter for low study hours AND absent
at_risk = df[ (df['study_hours'] < 2) & (df['attendance'] == 0) ]

# Show specific columns for these students
at_risk[['student_id', 'study_hours', 'absence_reason']]`,
                hint: "Don't forget parentheses around each condition: (cond1) & (cond2)"
            },
            {
                title: "Completion",
                type: "concept",
                heading: "Workshop Complete!",
                text: "Great job! You have successfully:<br>1. Loaded raw data.<br>2. Inspected it for errors.<br>3. Analyzed categorical reasons.<br>4. Checked correlations (Study time, Travel time).<br><br>These are the exact first steps a Data Scientist takes before building a Neural Network.",
                icon: "üéâ"
            }
        ];

        let currentStep = 0;
        let isCodeRevealed = false;

        // --- 3. UI RENDERING LOGIC ---
        function renderProgressBar() {
            const container = document.getElementById('stepContainer');
            container.innerHTML = '';
            
            // Only show dots for "task" steps to keep bar clean
            const taskSteps = steps.map((s, i) => ({...s, index: i})).filter(s => s.type === 'task' || s.title === 'Completion');

            taskSteps.forEach((step, idx) => {
                const dot = document.createElement('div');
                let statusClass = 'step-pending';
                
                if (currentStep > step.index) statusClass = 'step-done';
                if (currentStep === step.index || (steps[currentStep].type === 'concept' && currentStep === step.index + 1)) statusClass = 'step-active';

                dot.className = `w-8 h-8 rounded-full flex items-center justify-center border-2 font-bold text-xs cursor-default bg-white z-10 ${statusClass}`;
                dot.innerText = idx + 1;
                
                container.appendChild(dot);
            });
        }

        function renderContent() {
            const container = document.getElementById('contentArea');
            const step = steps[currentStep];

            // Animation reset
            container.classList.remove('fade-in');
            void container.offsetWidth; // trigger reflow
            container.classList.add('fade-in');

            if (step.type === 'task') {
                const codeDisplayClass = isCodeRevealed ? '' : 'code-blur';
                const buttonText = isCodeRevealed ? "I've run this code ‚Üí Next" : "Check My Code (Reveal Solution)";
                const buttonColor = isCodeRevealed ? "bg-green-600 hover:bg-green-700" : "bg-blue-600 hover:bg-blue-700";
                
                // Overlay logic
                let overlayHTML = '';
                if (!isCodeRevealed) {
                    overlayHTML = `
                        <div class="absolute inset-0 flex items-center justify-center z-10 reveal-overlay rounded-lg">
                            <div class="text-center p-4">
                                <p class="text-gray-600 font-semibold mb-2">Try to write it yourself in Colab first!</p>
                                <p class="text-sm text-gray-500">Click "Check My Code" below to see the answer.</p>
                            </div>
                        </div>
                    `;
                }

                container.innerHTML = `
                    <div class="bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-100">
                        <div class="bg-blue-600 p-6 text-white">
                            <h2 class="text-2xl font-bold mb-2">Task: ${step.title}</h2>
                            <p class="text-blue-100">${step.instruction}</p>
                        </div>
                        
                        <div class="p-8">
                            <div class="mb-6">
                                <h3 class="font-bold text-gray-700 mb-2">Instructions:</h3>
                                <p class="text-gray-600 mb-4">${step.task}</p>
                            </div>

                            <div class="relative group">
                                ${overlayHTML}
                                <div class="absolute -top-3 right-4 bg-gray-800 text-xs text-white px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity z-20">Copy</div>
                                <pre class="${codeDisplayClass} transition-all duration-500"><code class="python rounded-lg p-4 shadow-inner text-sm relative" id="codeBlock">${step.code}</code></pre>
                                
                                ${isCodeRevealed ? `
                                <button onclick="copyToClipboard()" class="absolute top-2 right-2 p-2 bg-gray-700/50 hover:bg-gray-700 rounded text-white transition-colors z-20">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                    </svg>
                                </button>` : ''}
                            </div>

                            <div class="mt-4 flex items-start gap-2 text-sm text-amber-600 bg-amber-50 p-3 rounded-lg border border-amber-100">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 flex-shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                                <p><strong>Hint:</strong> ${step.hint}</p>
                            </div>
                        </div>

                        <div class="p-6 bg-gray-50 border-t flex justify-end items-center">
                            <button onclick="handleMainButton()" class="${buttonColor} text-white px-8 py-3 rounded-xl font-bold shadow-lg transform hover:-translate-y-1 transition-all flex items-center gap-2">
                                ${buttonText}
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                                </svg>
                            </button>
                        </div>
                    </div>
                `;
            } else if (step.type === 'concept') {
                container.innerHTML = `
                    <div class="bg-gradient-to-br from-indigo-900 to-purple-900 rounded-2xl shadow-2xl overflow-hidden text-white relative">
                        <!-- Decorative circle -->
                        <div class="absolute top-0 right-0 w-64 h-64 bg-white opacity-5 rounded-full -translate-y-1/2 translate-x-1/3"></div>

                        <div class="p-10 text-center">
                            <div class="text-6xl mb-6 animate-bounce">${step.icon}</div>
                            <h2 class="text-3xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-purple-200 to-pink-200">${step.heading}</h2>
                            <div class="bg-white/10 p-6 rounded-xl backdrop-blur-sm border border-white/20 mb-8 text-lg leading-relaxed text-indigo-100 text-left">
                                ${step.text}
                            </div>
                            
                            <button onclick="nextStep()" class="bg-white text-indigo-900 hover:bg-indigo-50 px-10 py-3 rounded-full font-bold text-lg shadow-lg transition-colors inline-flex items-center gap-2">
                                ${currentStep === steps.length - 1 ? 'Finish Exercise' : 'Next Challenge'}
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
                                </svg>
                            </button>
                        </div>
                    </div>
                `;
            }

            // Apply syntax highlighting
            document.querySelectorAll('pre code').forEach((el) => {
                hljs.highlightElement(el);
            });
            
            renderProgressBar();
        }

        function handleMainButton() {
            if (!isCodeRevealed) {
                // Reveal code
                isCodeRevealed = true;
                renderContent();
            } else {
                // Go to next step
                nextStep();
            }
        }

        function nextStep() {
            if (currentStep < steps.length - 1) {
                currentStep++;
                isCodeRevealed = false; // Reset for next task
                renderContent();
            } else {
                // Reset or show final screen
                alert("Exercise Complete! You are ready for the next module.");
                currentStep = 0;
                isCodeRevealed = false;
                renderContent();
            }
        }

        function copyToClipboard() {
            const text = steps[currentStep].code;
            navigator.clipboard.writeText(text).then(() => {
                const btn = document.querySelector('button[onclick="copyToClipboard()"]');
                btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>`;
                setTimeout(() => {
                    btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>`;
                }, 2000);
            });
        }

        // Initialize
        renderContent();
    </script>
</body>
</html>